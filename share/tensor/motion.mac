/* Computes geodesic equations of motion */

motion(dis):=block([s],depends(ct_coords,s),
       for i thru dim do
	   em[i]:if diagmetric
		     then ratsimp(diff(ct_coords[i],s,2) + 1/2*sum(
				      diff(lg[a,a],ct_coords[i])
				       *diff(ct_coords[a],s)^2,a,1,dim))
		     else ratsimp(diff(ct_coords[i],s,2) 
				+ 1/2*sum(sum(diff(lg[a,b],ct_coords[i])
				       *diff(ct_coords[a],s)*diff(ct_coords[b],s),a,
				      1,dim),b,1,dim)),
       if dis#false then for i thru dim do ldisplay(em[i]),done)$
motion2(dis):=block([s],depends(ct_coords,s),
       for i thru dim do
	   emm[i]:diff(ct_coords[i],s,2) +			 sum(sum(mcs[a,b,i]
				       *diff(ct_coords[a],s)*diff(ct_coords[b],s),a,
				      1,dim),b,1,dim),
       if dis#false then for i thru dim do ldisplay(emm[i]),done)$
