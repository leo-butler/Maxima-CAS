# -*- mode: rpm-spec -*-
%define enable_clisp 1
%define clisp_flags --enable-clisp
%define enable_cmucl 1
%define cmucl_flags --enable-cmucl
%define enable_gcl 1
%define gcl_flags --enable-gcl

Summary: Maxima Symbolic Computation Program
Name: maxima
Version: @VERSION@
Release: 1
License: GPL
Group: Development/Languages
URL: http://maxima.sourceforge.net
Source0: %{name}-%{version}.tar.gz
BuildRoot: %{_tmppath}/%{name}-%{version}-buildroot
Requires: maxima_exec

%description

Maxima is a full symbolic computation program.  It is full featured
doing symbolic manipulation of polynomials, matrices, rational
functions, integration, Todd-coxeter, graphing, bigfloats.  It has a
symbolic debugger source level debugger for maxima code.  Maxima is
based on the original Macsyma developed at MIT in the 1970's.  It is
quite reliable, and has good garbage collection, and no memory leaks.
It comes with hundreds of self tests.

%package xmaxima
Summary: Tcl/Tk interface to Maxima
Group: Development/Languages
Requires: maxima tk
Provides: xmaxima
%description xmaxima
Tcl/Tk interface to Maxima.

%if %{enable_clisp}
%package exec_clisp
Summary: Maxima compiled with clisp
Group: Development/Languages
Requires: clisp maxima
Provides: maxima_exec
%description exec_clisp
Maxima compiled with clisp.
%endif

%if %{enable_cmucl}
%package exec_cmucl
Summary: Maxima compiled with CMUCL
Group: Development/Languages
Requires: cmucl maxima
Provides: maxima_exec
%description exec_cmucl
Maxima compiled with CMUCL.
%endif

%if %{enable_gcl}
%package exec_gcl
Summary: Maxima compiled with GCL
Group: Development/Languages
Requires: maxima
Provides: maxima_exec
%description exec_gcl
Maxima compiled with Gnu Common Lisp.
%endif

%prep
%setup -q
%configure  %{?cmucl_flags:} %{?gcl_flags:} %{?clisp_flags:}

%build
make

%install
rm -rf $RPM_BUILD_ROOT
%makeinstall

%post
/sbin/install-info %{_infodir}/maxima.info %{_infodir}/dir
gunzip %{_infodir}/maxima*.gz >& /dev/null || /bin/true

%postun
/sbin/install-info --delete %{_infodir}/maxima.info %{_infodir}/dir
rm %{_infodir}/maxima.info*

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root,-)
/usr/share/maxima/%{version}/*
/usr/libexec/maxima/%{version}
/usr/share/info/*.gz
/usr/share/man/man1/maxima.1.gz
/usr/bin/maxima

%files xmaxima
/usr/bin/xmaxima

%if %{enable_clisp}
%files exec_clisp
/usr/lib/maxima/%{version}/binary-clisp/*
%endif

%if %{enable_cmucl}
%files exec_cmucl
/usr/lib/maxima/%{version}/binary-cmucl/*
%endif

%if %{enable_gcl}
%files exec_gcl
/usr/lib/maxima/%{version}/binary-gcl/*
%endif

%doc


%changelog
* Sun Sep  8 2002 James Amundson <amundson@fnal.gov> 
- Initial build.


